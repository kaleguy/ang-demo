{"version":3,"sources":["calendar.controller.js"],"names":[],"mappings":"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","file":"calendar.controller-compiled.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular\n        .module('app.calendar')\n        .controller('CalendarController', CalendarController);\n\n\n    CalendarController.$inject =\n        ['$scope', '$timeout', '$compile', '$document', 'logger', 'uiCalendarConfig', 'CalendarService'];\n    /* @ngInject */\n    function CalendarController($scope, $timeout, $compile, $document, logger, uiCalendarConfig, CalendarService) {\n\n        var vm = this;\n        vm.title = 'Calendar';\n        var editable = true;\n        var events = [];\n\n        //  next two functions are for hiding popover.\n        //  (trigger:focus doesn't work with container: body)\n        $document.bind('keypress', function (e) {\n            if (e.keyCode === 27) {\n                $('.popover').popover('hide');\n                $scope.$apply();\n            }\n        });\n        $('body').on('click', function (e) {\n            let a = $(e.target).parents('A');\n            let pop_id = a.attr(\"aria-describedby\");\n            if (pop_id) {\n                $timeout(function () {\n                    let pop = $(\".popover[id!=\" + pop_id + \"]\");\n                    if (pop) {\n                        pop.popover('hide');\n                    }\n                }, 1);\n            } else {\n                $('.popover').popover('hide');\n            }\n        });\n\n        var data  = CalendarService.getCalendarData();\n\n        const refresh = (force) => events.push(data.dummyEvents);\n        refresh();\n\n        /**\n         * ========== FullCalendar Setup ==============\n         */\n        let buttonIcons = {\n            refresh: 'left-single-arrow'\n        };\n        $scope.uiConfig = {\n\n            calendar: {\n                height: 'auto',\n                editable: editable,\n                droppable: true,\n                timezone: \"local\",\n                buttonIcons: buttonIcons,\n                header: {\n                    left: 'prev,next today',\n                    center: 'title',\n                    right: 'month,agendaWeek,agendaDay'\n                },\n                dayClick,\n                eventClick,\n                viewRender\n            }\n        };\n        $scope.eventSources = events;\n\n        /**\n         * eventClick: show bootstrap popover with event info\n         * @param calEvent\n         * @param jsEvent\n         */\n        function eventClick (calEvent, jsEvent) {\n\n           // let eventClicked = true;\n            let el = $(jsEvent.currentTarget);\n            let item = calEvent;\n\n            // use an underscore template for the first pass on the content\n            // because apparently not possible to get the height right when\n            // using ng $compile\n            let template = _.template($('#cal_pop').html());\n\n            function _showPopover(el) {\n\n                el.popover('show');\n                el.attr('pop', true);\n                let popid = '#' + el.attr(\"aria-describedby\");\n                el.attr('tabindex', 0);\n                el.attr('role', 'button');\n\n                // Once content is drawn, we can $compile it to get the ng commands to work\n                let contentEl = $(popid + ' .popover-content');\n                let contentElChild = $(popid + ' .tool-content');\n                let ng_template = contentElChild.html();\n                let ng_el = angular.element(ng_template);\n                let compiled = $compile(ng_el);\n                contentElChild.remove();\n                contentEl.append(ng_el);\n                compiled($scope);\n\n            }\n\n            el.popover({\n                title : item.title,\n                placement: 'right',\n                container: 'body',\n                html: true,\n                trigger: 'focus',\n                content: () => template(item)\n            });\n\n            _showPopover(el);\n\n        }\n\n        /* Navigate to the Agenda view of a particular day on clicking the day cell of the Month view */\n        function dayClick (date) { // view, calendar\n            let c = uiCalendarConfig.calendars.mainCalendar;\n            c.fullCalendar('changeView', 'agendaDay');\n            c.fullCalendar('gotoDate', date);\n            $('.popover').popover('hide');\n        }\n\n        function viewRender(){}\n\n\n        activate();\n        function activate() {\n            logger.info('Activated Calendar View');\n        }\n    }\n})();\n"]}